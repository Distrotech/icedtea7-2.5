# HG changeset patch
# User hseigel
# Date 1396877251 14400
#      Mon Apr 07 09:27:31 2014 -0400
# Node ID b5ae226b7516460566347e45980e01b10a02b47d
# Parent  0037e964ce486c009984171f004259263628079f
8037157: Verify <init> call
Summary: Check for null method
Reviewed-by: coleenp, acorn, mschoene

diff -r 0037e964ce48 -r b5ae226b7516 src/share/vm/classfile/verifier.cpp
--- openjdk/hotspot/src/share/vm/classfile/verifier.cpp	Thu Apr 03 11:46:36 2014 -0700
+++ openjdk/hotspot/src/share/vm/classfile/verifier.cpp	Mon Apr 07 09:27:31 2014 -0400
@@ -2307,6 +2307,11 @@
       Method* m = InstanceKlass::cast(ref_klass)->uncached_lookup_method(
         vmSymbols::object_initializer_name(),
         cp->signature_ref_at(bcs->get_index_u2()));
+      if (m == NULL) {
+        verify_error(ErrorContext::bad_code(bci),
+            "Call to missing <init> method");
+        return;
+      }
       instanceKlassHandle mh(THREAD, m->method_holder());
       if (m->is_protected() && !mh->is_same_class_package(_klass())) {
         bool assignable = current_type().is_assignable_from(
